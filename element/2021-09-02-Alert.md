---
slug: Alert
title: Alert
authors: lsh
tags: [element,alert]
---

## Source Code

```html title="packages/alert/src/main.vue"
<template>
  <transition name="el-alert-fade">
    <div
      class="el-alert"
      :class="[typeClass, center ? 'is-center' : '', 'is-' + effect]"
      v-show="visible"
      role="alert"
    >
      <i class="el-alert__icon" :class="[ iconClass, isBigIcon ]" v-if="showIcon"></i>
      <div class="el-alert__content">
        <span class="el-alert__title" :class="[ isBoldTitle ]" v-if="title || $slots.title">
          <slot name="title">{{ title }}</slot>
        </span>
        <p class="el-alert__description" v-if="$slots.default && !description"><slot></slot></p>
        <p class="el-alert__description" v-if="description && !$slots.default">{{ description }}</p>
        <i class="el-alert__closebtn" :class="{ 'is-customed': closeText !== '', 'el-icon-close': closeText === '' }" v-show="closable" @click="close()">{{closeText}}</i>
      </div>
    </div>
  </transition>
</template>

<script type="text/babel">
  const TYPE_CLASSES_MAP = {
    'success': 'el-icon-success',
    'warning': 'el-icon-warning',
    'error': 'el-icon-error'
  };
  export default {
    name: 'ElAlert',

    props: {
      title: {
        type: String,
        default: ''
      },
      description: {
        type: String,
        default: ''
      },
      type: {
        type: String,
        default: 'info'
      },
      closable: {
        type: Boolean,
        default: true
      },
      closeText: {
        type: String,
        default: ''
      },
      showIcon: Boolean,
      center: Boolean,
      effect: {
        type: String,
        default: 'light',
        validator: function(value) {
          return ['light', 'dark'].indexOf(value) !== -1;
        }
      }
    },

    data() {
      return {
        visible: true
      };
    },

    methods: {
      close() {
        this.visible = false;
        this.$emit('close');
      }
    },

    computed: {
      typeClass() {
        return `el-alert--${ this.type }`;
      },

      iconClass() {
        return TYPE_CLASSES_MAP[this.type] || 'el-icon-info';
      },

      isBigIcon() {
        return this.description || this.$slots.default ? 'is-big' : '';
      },

      isBoldTitle() {
        return this.description || this.$slots.default ? 'is-bold' : '';
      }
    }
  };
</script>

```


## Title

|  参数   | 说明  | 类型 | 可选值 | 默认值
|  ----  | ----  | ---- | ---- | ----|
| title  | 标题 | string | - | -

**title**属性有两种作用方式：
- :heavy_check_mark:可以作为属性传入组件中
- :heavy_check_mark:作为插槽传入，从而允许内容更加灵活

```html title="17-24行" {2,3,4}
<div class="el-alert__content">
    <span class="el-alert__title" :class="[ isBoldTitle ]" v-if="title || $slots.title">
        <slot name="title">{{ title }}</slot>
    </span>
    <p class="el-alert__description" v-if="$slots.default && !description"><slot></slot></p>
    <p class="el-alert__description" v-if="description && !$slots.default">{{ description }}</p>
    <i class="el-alert__closebtn" :class="{ 'is-customed': closeText !== '', 'el-icon-close': closeText === '' }" v-show="closable" @click="close()">{{closeText}}</i>
</div>
```
`v-if="title || $slots.title"`的意思意味着：

如果传入了**title**属性或者传入了**title**插槽，`<slot name="title">{{ title }}</slot>`将会被渲染

- :wave: 如果只传入**title**属性，`{{title}}`将会被渲染
- :wave: 如果传入了**slot**插槽，**slot**将会被渲染为插槽的内容，`{{title}}`的内容会被覆盖
- :open_hands:如果二者都传入，根据**Vue**的语法规则，[渲染以slot插槽优先](https://cn.vuejs.org/v2/guide/components-slots.html#%E5%90%8E%E5%A4%87%E5%86%85%E5%AE%B9)

**Usage**
```diff 
- <el-alert title="属性警告">
+ <el-alert>
+     <template v-slot:title>插槽警告</template>
  <el-alert>

```

## Description

|  参数   | 说明  | 类型 | 可选值 | 默认值
|  ----  | ----  | ---- | ---- | ----|
| description  | 辅助性文字 | string | - | -

**description**属性的用法类似**title**属性,但是它们再源码中的写法是不同的

```html {5,6}
<div class="el-alert__content">
    <span class="el-alert__title" :class="[ isBoldTitle ]" v-if="title || $slots.title">
        <slot name="title">{{ title }}</slot>
    </span>
    <p class="el-alert__description" v-if="$slots.default && !description"><slot></slot></p>
    <p class="el-alert__description" v-if="description && !$slots.default">{{ description }}</p>
    <i class="el-alert__closebtn" :class="{ 'is-customed': closeText !== '', 'el-icon-close': closeText === '' }" v-show="closable" @click="close()">{{closeText}}</i>
</div>
```

:point_right:第五行的`v-if="$slots.default && !description"`内容意味着:
只传入默认**slot插槽**且不传入**description**属性时，将会在`<slot></slot>`中渲染插槽的内容

:point_right:第六行的`v-if="description && !$slots.default"`内容意味着:
只传入**description**属性且不传入**slot插槽**时，将会渲染`{{ description }}`中的内容

:confused:或许你会想到，这不是和**title**一样的道理嘛，是否可以用如下形式代替呢？
```diff {5,6}
<div class="el-alert__content">
    <span class="el-alert__title" :class="[ isBoldTitle ]" v-if="title || $slots.title">
        <slot name="title">{{ title }}</slot>
    </span>
-   <p class="el-alert__description" v-if="$slots.default && !description"><slot></slot></p>
-   <p class="el-alert__description" v-if="description && !$slots.default">{{ description }}</p>
+   <p class="el-alert__description" v-if="description || $slots.default">
+       <slot>{{description}}</slot>
+   </p>
    <i class="el-alert__closebtn" :class="{ 'is-customed': closeText !== '', 'el-icon-close': closeText === '' }" v-show="closable" @click="close()">{{closeText}}</i>
</div>
```
就目前而言，上面的**description**两种写法效果相差不多，区别就是当属性和插槽都有的时候，`title`选择让插槽覆盖属性，而`description`选择都不渲染

:::caution
同时传入**description**属性和插槽，二者都不会渲染，Element官方文档没有明确提及！
:::

除此之外，description还有另一个作用，我们来看看element还将description用在了哪：

```html {7,9,21,24}
<div
      class="el-alert"
      :class="[typeClass, center ? 'is-center' : '', 'is-' + effect]"
      v-show="visible"
      role="alert"
    >
        <i class="el-alert__icon" :class="[ iconClass, isBigIcon ]" v-if="showIcon"></i>
        <div class="el-alert__content">
        <span class="el-alert__title" :class="[ isBoldTitle ]" v-if="title || $slots.title">
            <slot name="title">{{ title }}</slot>
        </span>
        <p class="el-alert__description" v-if="$slots.default && !description"><slot></slot></p>
        <p class="el-alert__description" v-if="description && !$slots.default">{{ description }}</p>
        <i class="el-alert__closebtn" :class="{ 'is-customed': closeText !== '', 'el-icon-close': closeText === '' }" v-show="closable" @click="close()">{{closeText}}</i>
      </div>
</div>

<script type="text/babel">
    computed: {
        isBigIcon() {
            return this.description || this.$slots.default ? 'is-big' : '';
        },
        isBoldTitle() {
            return this.description || this.$slots.default ? 'is-bold' : '';
        }
    }
</script>
```

根据计算属性`isBigIcon()`和`isBoldTitle`我们可以看出:

:ok:如果传入了**description**属性，或者默认插槽，`icon`将会被渲染为大图标，同时`title`的字体也被加粗




## type

|  参数   | 说明  | 类型 | 可选值 | 默认值
|  ----  | ----  | ---- | ---- | ----|
| type  | 主题 | string | success/warning/info/error | info 

**type**属性的改变将会改变组件主题，除了要改变背景颜色和文字颜色之外，还要改变对应的`icon`

```html {3,7,20,24}
<div
      class="el-alert"
      :class="[typeClass, center ? 'is-center' : '', 'is-' + effect]"
      v-show="visible"
      role="alert"
    >
        <i class="el-alert__icon" :class="[ iconClass, isBigIcon ]" v-if="showIcon"></i>
        <!-- 省略 -->
</div>

<script type="text/babel">
    const TYPE_CLASSES_MAP = {
        'success': 'el-icon-success',
        'warning': 'el-icon-warning',
        'error': 'el-icon-error'
    }; 

    computed: {
        typeClass() {
            return `el-alert--${ this.type }`;
        },

        iconClass() {
            return TYPE_CLASSES_MAP[this.type] || 'el-icon-info';
        },
    }
</script>
```

:raised_hand_with_fingers_splayed:组件根据传入的type值，切换标签的`el-alert--${ this.type }`类，从而做到主题的切换

`TYPE_CLASSES_MAP`则控制了渲染哪一个图标，类是怎么控制`icon`样式的可以看这一节

## closable/closeText

|  参数   | 说明  | 类型 | 可选值 | 默认值
|  ----  | ----  | ---- | ---- | ----|
| closable  | 是否可关闭 | boolean | - | true
| close-text  | 关闭按钮自定义文本 | string	 | - | -

closeable/closeText的实现也比较简单：

```html title="closeable解析" {5,10,11,12,23,24}
<template>
    <div
      class="el-alert"
      :class="[typeClass, center ? 'is-center' : '', 'is-' + effect]"
      v-show="visible"
      role="alert"
    >
        <i  
            class="el-alert__closebtn" 
            :class="{ 'is-customed': closeText !== '', 'el-icon-close': closeText === '' }"
            v-show="closable" 
            @click="close()"
        >
            {{closeText}}
        </i>
    </div>
</template>

<script>
    export default {
         methods: {
            close() {
                this.visible = false;
                this.$emit('close');
            }
        },
    }
</script>
```

**closable**

`v-show="closable"`直接控制了图标的显示与否


**closeText**

:one:首先，默认情况下，由于`'el-icon-close': closeText === ''`，所以`el-icon-close`类会被渲染

:two:渲染出来的**icon**用于标签的关闭，点击后执行`this.visible = false`隐藏该组件，并用[this.$emit](https://cn.vuejs.org/v2/guide/components-custom-events.html)发送自定义事件`close`让父级监听

:three:当组件传入**closeText**属性，`is-customed`类相会被渲染，同时，关闭的图标会变为`{{closeText}}`的内容


## center/showIcon/effect

最后三个属性实现非常简单，这里一笔带过:airplane:

**effect/center**

- :key:判断是否传入了**center**属性决定是否渲染`is-center`类
- :key:直接根据传入的**effect**值，渲染`is-effect`类
```html {3}
<div
    class="el-alert"
    :class="[typeClass, center ? 'is-center' : '', 'is-' + effect]"
    v-show="visible"
    role="alert"
>
    <!-- ... -->
</div>
```

**show-icon**
是否渲染关闭图标,如下：

```html
<i class="el-alert__icon" :class="[ iconClass, isBigIcon ]" v-if="showIcon"></i>
```

:::info
Alert的源码理解起来不难，但Alert除了在`.vue`文件中作为组件使用，我们后面还可以用API调用，以弹窗的形式出现
:::

## get

- :books: `this.$slots`可以获得插槽的内容，在封装组件时，可以准确判断使用者是否传值了，例如`$slots.title`会得到**title**插槽的**VNode**，而`$slots.default`得到是默认插槽的**VNode**，[$slots描述](https://cn.vuejs.org/v2/api/#vm-slots)

- :books: 组件体现出来的样式多样性，大部分的封装都是通过切换类实现的，具体用哪一个类，基于用户传入的属性，有大概这几种方法：
  - 判断某个类是否需要:
  `:class="[center ? 'is-center' : '']`
  - 字符串类拼接：
  `:class="['is-' + effect]"`
  - 通过计算属性计算复杂表达式：
  `isBigIcon() {
        return this.description || this.$slots.default ? 'is-big' : '';
      },`
